syntax = "proto3";
import "google/protobuf/empty.proto";

// OrderbookService provides operations for managing orders in a financial trading system.
// This service supports both limit orders and market orders with various order types.
service OrderbookService {
  // AddOrder places a new limit order with a specified price.
  // The order will be added to the order book and matched according to the specified order type.
  rpc AddOrder(AddOrderRequest) returns (AddOrderResponse);
  
  // AddMarketOrder places a new market order.
  // Market orders are executed immediately at the best available price in the market.
  rpc AddMarketOrder(AddMarketOrderRequest) returns (AddOrderResponse);

  // CancelOrder removes an existing order from the order book.
  // The order to be cancelled is identified by its unique order ID.
  rpc CancelOrder(CancelOrderRequest) returns (google.protobuf.Empty);
}

// Side represents whether an order is to buy or sell an asset.
enum Side {
  // Buy indicates the order is to purchase the asset.
  BUY = 0;
  
  // Sell indicates the order is to sell the asset.
  SELL = 1;
}

// OrderType defines the time-in-force and execution behavior of an order.
enum OrderType {
  // GoodTillCancel: Order remains active until explicitly cancelled by the user.
  GOOD_TILL_CANCEL = 0;
  
  // FillAndKill: Order must be filled immediately in its entirety or cancelled.
  FILL_AND_KILL = 1;
  
  // FillOrKill: Order must be filled immediately, either completely or not at all.
  FILL_OR_KILL = 2;
  
  // GoodForDay: Order remains active until the end of the trading day.
  GOOD_FOR_DAY = 3;
}

// AddMarketOrderRequest contains the parameters for placing a market order.
// Market orders are executed at the current best available market price.
message AddMarketOrderRequest {
  // side indicates whether this is a buy or sell order.
  Side side = 1;
  
  // quantity is the number of units to buy or sell.
  uint32 quantity = 2;
}

// AddOrderRequest contains the parameters for placing a limit order.
// Limit orders are executed at a specified price or better.
message AddOrderRequest {
  // side indicates whether this is a buy or sell order.
  Side side = 1;
  
  // orderType defines how the order should be handled (e.g., GoodTillCancel, FillAndKill).
  OrderType order_type = 2;
  
  // price is the limit price at which the order should be executed.
  // For buy orders, this is the maximum price to pay.
  // For sell orders, this is the minimum price to accept.
  uint32 price = 3;
  
  // quantity is the number of units to buy or sell.
  uint32 quantity = 4;
}

message CancelOrderRequest {
  // order_id is the unique identifier of the order to be cancelled.
  uint64 order_id = 1;
}

message TradeInfo {
  // order Id of the order executed as part of Trade
  uint64 order_id = 1;

  // price at which trade was executed
  uint32 price = 2; 

  // quantity at which trade was executed
  uint32 quantity = 3; 
}

message Trade {
  // bid_trade contains details of the trade executed for the bid order.
  TradeInfo bid_trade = 1;

  // ask_trade contains details of the trade executed for the ask order.
  TradeInfo ask_trade = 2;
}

// AddOrderResponse contains the result of an order placement operation.
message AddOrderResponse {
  // trades is a list of trades that were executed as a result of placing the order.
  repeated Trade trades = 1;
}
